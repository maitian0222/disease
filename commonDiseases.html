<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"
    />
    <meta http-equiv="X-UA-Compatible" content="ie=edge,chrome=1" />
    <link rel="stylesheet" href="./css/commonDiseases.css" />
    <title>常见疾病</title>
  </head>
  <body>
    <div class="main">
      <div class="aside"></div>
      <div class="content"></div>
    </div>
    <script src="./js/polyfill.min.js"></script>
    <script src="./js/babel.min.js"></script>
    <script src="./js/jquery.js"></script>
    <script type="text/babel">
      var data = [
        {
          type: "female",
          title: "女性",
          diseases: [
            {
              title: "阴道炎",
              url: ""
            },
            {
              title: "月经不调",
              url: ""
            },
            {
              title: "女性不孕症",
              url: ""
            },
            {
              title: "功血",
              url: ""
            },
            {
              title: "宫颈糜烂",
              url: ""
            },
            {
              title: "子宫肌瘤",
              url: ""
            },
            {
              title: "乳腺炎",
              url: ""
            },
            {
              title: "乳腺癌",
              url: ""
            },
            {
              title: "盆腔炎",
              url: ""
            }
          ]
        },
        {
          type: "children",
          title: "儿童",
          diseases: [
            {
              title: "小儿腹泻",
              url: ""
            },
            {
              title: "小儿肺炎",
              url: ""
            },
            {
              title: "小儿湿疹",
              url: ""
            },
            {
              title: "小儿食积",
              url: ""
            },
            {
              title: "儿童遗尿症",
              url: ""
            },
            {
              title: "手足口病",
              url: ""
            },
            {
              title: "鹅口疮",
              url: ""
            }
          ]
        },
        {
          type: "male",
          title: "男性",
          diseases: [
            {
              title: "前列腺炎",
              url: ""
            },
            {
              title: "龟头炎",
              url: ""
            },
            {
              title: "阳痿",
              url: ""
            },
            {
              title: "早泄",
              url: ""
            },
            {
              title: "包皮过长",
              url: ""
            },
            {
              title: "睾丸炎",
              url: ""
            },
            {
              title: "前列腺增生",
              url: ""
            },
            {
              title: "精囊炎",
              url: ""
            },
            {
              title: "男性不孕症",
              url: ""
            }
          ]
        },
        {
          type: "worker",
          title: "上班族",
          diseases: [
            {
              title: "颈椎病",
              url: ""
            },
            {
              title: "鼠标手",
              url: ""
            },
            {
              title: "屏幕脸",
              url: ""
            },
            {
              title: "腰椎病",
              url: ""
            },
            {
              title: "干眼",
              url: ""
            },
            {
              title: "紧张性头痛",
              url: ""
            },
            {
              title: "空调病",
              url: ""
            },
            {
              title: "失眠症",
              url: ""
            },
            {
              title: "胃病",
              url: ""
            }
          ]
        },
        {
          type: "older",
          title: "老人",
          diseases: [
            {
              title: "白内障",
              url: ""
            },
            {
              title: "骨关节炎",
              url: ""
            },
            {
              title: "动脉硬化",
              url: ""
            },
            {
              title: "中风",
              url: ""
            },
            {
              title: "冠心病",
              url: ""
            },
            {
              title: "骨质疏松",
              url: ""
            },
            {
              title: "心律失常",
              url: ""
            },
            {
              title: "老年痴呆",
              url: ""
            },
            {
              title: "远视眼",
              url: ""
            }
          ]
        }
      ];

      $(function() {
        $('.aside').append('<ul class="type-list"></ul>');
        data.map(function(item, index) {
          var li = `<li onclick="changeContent('${
            item.type
          }',this)" data-type="${item.type}" class=${
            index === 0 ? "active" : ""
          }>
            <div class="icon"><img src="./images/icon_${
              index === 0 ? `${item.type}_active` : item.type
            }.png" /></div>
            <div class="text">${item.title}</div>
          </li>`;
          $(".type-list").append(li);
        });
        
        initActive(data[0].type);

        //  点击常见疾病跳转疾病详情页面
        $(document).on("click", ".operation-item", function() {
          const htmlName = $(this).attr("data-name");
          $(".operation-item").removeClass("active");
          $(".operation-item img").each(function() {
            $(this).attr(
              "src",
              $(this)
                .attr("src")
                .replace("_active", "")
            );
          });
          $(this).addClass("active");
          $(this)
            .children("img")
            .attr("src", "./images/icon_heart_active.png");
          // window.location.href = htmlName;
        });
      });

      function initActive(type) {
        $(".content").empty();
        var diseasesList = [];
        const findType = data.find(function(item) {
          if (item.type === type) {
            return item;
          }
          return undefined;
        });
        for (var i = 0; i < findType.diseases.length; i += 3) {
          diseasesList.push(findType.diseases.slice(i, i + 3));
        }
        diseasesList.map(function(item) {
          var str = "";
          item.map(function(d) {
            str += `<div class="operation-item-container"><div class="operation-item" data-name="${d.url}">
            <img src="./images/icon_heart.png" />
            <div>${d.title}</div>
          </div></div>`;
          });
          str = `<div class="operation-row">${str}</div>`;
          $(".content").append($(str));
        });
      }

      function changeContent(type) {
        initActive(type);
        // 选项高亮
        $("[data-type]").removeClass("active");
        $("[data-type] img").each(function() {
          $(this).attr(
            "src",
            $(this)
              .attr("src")
              .replace("_active", "")
          );
        });

        $('[data-type="' + type + '"]').addClass("active");
        $('[data-type="' + type + '"] img').attr(
          "src",
          `./images/icon_${type}_active.png`
        );
      }
    </script>
  </body>
</html>
